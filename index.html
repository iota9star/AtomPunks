<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>AtomPunks</title>
</head>
<body>
    <style>
        body {
            background-color: rgb(208, 208, 224);
        }

        .darkened {
            filter: brightness(0.5);
        }

        #pagination a {
            margin-right: 3px;
        }
    </style>

    <h1>AtomPunks</h1>
    <div id="pagination"></div>
    <div id="nft-list"></div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script> <!-- 引入 Axios 库 -->

    <script>
        let nftData = [];

        async function fetchData() {
            try {
                const response = await axios.get('10kpunk_data.json'); // 使用 Axios 获取数据
                if (response.status === 200) {
                    nftData = response.data;
                    renderPage(1);
                    renderPagination();
                } else {
                    console.error('Failed to fetch data');
                }
            } catch (error) {
                console.error('Error fetching data:', error);
            }
        }

        fetchData();

        const itemsPerPage = 200;
        let totalPages = 0;

        function hexToBase64(hex) {
            const buffer = new Uint8Array(hex.match(/.{1,2}/g).map(byte => parseInt(byte, 16)));
            return btoa(String.fromCharCode.apply(null, buffer));
        }

        function renderPage(page) {
            if (!nftData || nftData.length === 0) return;

            const start = (page - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const pageData = nftData.slice(start, end);

            const nftList = document.getElementById('nft-list');
            nftList.innerHTML = '';

            pageData.forEach(item => {
                const nftItem = document.createElement('div');

                const base64Data = hexToBase64(item.hex);

                const image = document.createElement('img');
                image.src = `data:image/png;base64,${base64Data}`;
                nftItem.appendChild(image);

                const punkIdLabel = document.createElement('div');
                punkIdLabel.textContent = `Punk ID: ${item.punk_id}`;
                nftItem.appendChild(punkIdLabel);

                nftItem.innerHTML += `Mint: ${item.mint}, Atomial Number: ${item.atomical_number}`;
                nftList.appendChild(nftItem);

                if (item.mint) {
                    image.classList.add('darkened');
                }
            });
        }

        function renderPagination() {
            totalPages = Math.ceil(nftData.length / itemsPerPage);
            const pagination = document.getElementById('pagination');
            pagination.innerHTML = '';

            for (let i = 1; i <= totalPages; i++) {
                const pageLink = document.createElement('a');
                pageLink.href = 'javascript:void(0);';
                pageLink.textContent = i;
                pageLink.addEventListener('click', () => renderPage(i));
                pagination.appendChild(pageLink);

                if (i < totalPages) {
                    // 插入间隔元素（可以是空格、竖线等）
                    const separator = document.createElement('span');
                    separator.textContent = ' | ';
                    pagination.appendChild(separator);
                }
            }
        }
    </script>
</body>
</html>
